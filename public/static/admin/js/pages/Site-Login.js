"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3202],{5972:(t,a,s)=>{s.r(a),s.d(a,{default:()=>r});var o=s(5838);s(3073);const e={name:"SiteLogin",props:{urls:Object,configs:Object},data:function(){return{trans:{},footer:{},logo:null,backgrounds:[],captcha_url:null,logging:!1,login_error:null,login_form:{username:null,password:null,captcha:null,remember:!1},two_fa_url:null,two_fa_seconds:0,two_fa_code:null}},created:function(){this.getUI()},mounted:function(){},watch:{"login_form.username":function(t){this.filled(t)&&(this.login_error=null)},"login_form.password":function(t){this.filled(t)&&(this.login_error=null)},"login_form.captcha":function(t){this.filled(t)&&(this.login_error=null)}},computed:{verify_timer:function(){var t=this,a=this.array_get(this.trans,"module.message.verify_timer");return this.blank(a)?null:this.blank(this.two_fa_url)?a.replace("{0}","--:--"):this.two_fa_seconds<=0?a.replace("{0}","0:00"):(setTimeout((function(){return t.two_fa_seconds--}),1e3),a.replace("{0}",Math.floor(this.two_fa_seconds/60)+":"+(this.two_fa_seconds%60<10?"0":"")+this.two_fa_seconds%60))}},methods:{getUI:function(){var t=this;axios.get(this.urls.api_ui).then((function(a){t.trans=a.data.data.trans,t.footer=a.data.data.footer,t.logo=a.data.data.logo,t.backgrounds=a.data.data.backgrounds})).finally((function(){t.reCaptcha(),t.$nextTick((function(){t.applySwiper()}))}))},submitLogin:function(t){13===t.keyCode&&this.login()},login:function(){var t=this;if(this.validateLogin()){var a=Object.assign({},this.login_form);a.username=this.loginEncrypt(a.username,5),a.password=this.loginEncrypt(a.password,7),this.logging=!0,axios.post(this.urls.api_attempt,a).then((function(a){"0000"===a.data.code&&(t.filled(t.array_get(a.data.data,"redirect_to"))?location.href=a.data.data.redirect_to:t.filled(t.array_get(a.data.data,"api_two_fa"))?(t.two_fa_url=t.array_get(a.data.data,"api_two_fa"),t.two_fa_seconds=t.array_get(a.data.data,"seconds"),t.two_fa_code=null,t.logging=!1):t.logging=!1)})).catch((function(a){t.logging=!1,t.login_error=a.response.data.message})).finally((function(){t.logging||t.reCaptcha()}))}},reCaptcha:function(){this.filled(this.urls.api_captcha)?this.captcha_url=this.urls.api_captcha.replace(/\/$/,"")+"/"+(new Date).getTime():this.captcha_url=null},applySwiper:function(){this.filled(this.backgrounds)&&new o.Z("#login-swiper",{allowTouchMove:!1,autoplay:{delay:3e3},effect:"fade",speed:1e3})},validateLogin:function(){return this.blank(this.login_form.username)?(this.login_error=this.array_get(this.trans,"module.error.username_empty"),!1):this.blank(this.login_form.password)?(this.login_error=this.array_get(this.trans,"module.error.password_empty"),!1):!this.blank(this.login_form.captcha)||(this.login_error=this.array_get(this.trans,"module.error.captcha_empty"),!1)},loginEncrypt:function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;if(this.blank(t))return null;var s=btoa(escape(t)),o=document.head.querySelector('meta[name="csrf-token"]').content;return s.substr(0,a)+o.substr(0,a+2)+s.substr(a)+o.substr(a+2)},resetLogin:function(){this.login_form.username=null,this.login_form.password=null,this.login_form.captcha=null,this.two_fa_url=null,this.two_fa_code=null,this.two_fa_seconds=0,this.logging=!1,this.login_error=null},submitVerify:function(t){13===t.keyCode&&this.twoFAVerify()},twoFAVerify:function(){var t=this;if(this.blank(this.two_fa_url)||this.blank(this.two_fa_code)||this.two_fa_seconds<=0)return!1;this.logging=!0,axios.post(this.two_fa_url,{verify_code:this.two_fa_code}).then((function(a){"0000"===a.data.code&&(t.filled(t.array_get(a.data.data,"redirect_to"))?location.href=a.data.data.redirect_to:t.logging=!1)})).catch((function(a){t.logging=!1,t.login_error=a.response.data.message})).finally((function(){t.logging||t.reCaptcha()}))}}};const r=(0,s(1900).Z)(e,(function(){var t=this,a=t._self._c;return a("div",{staticClass:"wrapper user-login2"},[a("div",{staticClass:"login-container container"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-auto col text-center"},[t.blank(t.two_fa_url)?a("div",{staticClass:"login-content text-center text-sm-left"},[t.filled(t.logo)?a("h1",{staticClass:"text-main h3"},[a("span",{staticClass:"login-logo d-block d-sm-inline"},[a("img",{staticClass:"mb-3",staticStyle:{"max-height":"42px"},attrs:{src:t.logo,alt:""}})]),a("br"),a("span",{staticClass:"d-block d-sm-inline"},[t._v(t._s(t.array_get(t.trans,"title")))])]):a("h1",{staticClass:"text-main h3"},[a("span",{staticClass:"d-block d-sm-inline"},[t._v(t._s(t.array_get(t.trans,"title")))])]),t._v(" "),a("div",{staticClass:"login-form mt-4",on:{keypress:function(a){return t.submitLogin(a)}}},[a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-auto col-form-label",attrs:{for:"login-username"}},[t._v("\n                "+t._s(t.array_get(t.trans,"module.username"))+"\n              ")]),t._v(" "),a("div",{staticClass:"col"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.login_form.username,expression:"login_form.username"}],staticClass:"form-control",attrs:{id:"login-username",type:"text",autocomplete:"off",required:""},domProps:{value:t.login_form.username},on:{input:function(a){a.target.composing||t.$set(t.login_form,"username",a.target.value)}}})]),t._v(" "),t._m(0)]),t._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-auto col-form-label",attrs:{for:"login-password"}},[t._v("\n                "+t._s(t.array_get(t.trans,"module.password"))+"\n              ")]),t._v(" "),a("div",{staticClass:"col"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.login_form.password,expression:"login_form.password"}],staticClass:"form-control",attrs:{id:"login-password",type:"password",autocomplete:"off",required:""},domProps:{value:t.login_form.password},on:{input:function(a){a.target.composing||t.$set(t.login_form,"password",a.target.value)}}})]),t._v(" "),t._m(1)]),t._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-auto col-form-label",attrs:{for:"login-captcha"}},[t._v("\n                "+t._s(t.array_get(t.trans,"module.captcha"))+"\n              ")]),t._v(" "),a("div",{staticClass:"col"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.login_form.captcha,expression:"login_form.captcha"}],staticClass:"form-control",attrs:{type:"text",id:"login-captcha",autocomplete:"off",required:""},domProps:{value:t.login_form.captcha},on:{input:function(a){a.target.composing||t.$set(t.login_form,"captcha",a.target.value)}}})]),t._v(" "),a("div",{staticClass:"col-sm-auto d-md-block"},[t.filled(t.captcha_url)?a("img",{staticStyle:{width:"100px",height:"auto",cursor:"pointer"},attrs:{src:t.captcha_url,alt:""},on:{click:function(a){return t.reCaptcha()}}}):t._e()])]),t._v(" "),a("div",{staticClass:"row align-items-center mt-4"},[a("div",{staticClass:"col"},[a("div",{staticClass:"custom-control custom-checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.login_form.remember,expression:"login_form.remember"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"remember",value:"1"},domProps:{checked:Array.isArray(t.login_form.remember)?t._i(t.login_form.remember,"1")>-1:t.login_form.remember},on:{change:function(a){var s=t.login_form.remember,o=a.target,e=!!o.checked;if(Array.isArray(s)){var r=t._i(s,"1");o.checked?r<0&&t.$set(t.login_form,"remember",s.concat(["1"])):r>-1&&t.$set(t.login_form,"remember",s.slice(0,r).concat(s.slice(r+1)))}else t.$set(t.login_form,"remember",e)}}}),t._v(" "),a("label",{staticClass:"custom-control-label",attrs:{for:"remember"}},[t._v("\n                    "+t._s(t.array_get(t.trans,"module.remember_me"))+"\n                  ")])])]),t._v(" "),a("div",{staticClass:"col-sm text-md-right col-xs-12 text-center mt-4 mt-md-2"},[t.logging?a("button",{staticClass:"btn btn-main btn-lg rounded",attrs:{type:"button",disabled:""}},[t._v("\n                  "+t._s(t.array_get(t.trans,"module.button.logging"))+"\n                ")]):a("button",{staticClass:"btn btn-main btn-lg rounded",attrs:{type:"button"},on:{click:function(a){return t.login()}}},[t._v("\n                  "+t._s(t.array_get(t.trans,"module.button.login"))+"\n                ")])])]),t._v(" "),a("div",{staticClass:"alert alert-danger error fade mt-3",class:{show:t.filled(t.login_error)},attrs:{role:"alert"}},[a("span",{staticClass:"text"},[t._v(t._s(t.login_error)+"Â ")])])])]):t.filled(t.two_fa_url)?a("div",{staticClass:"login-content text-center text-sm-left"},[t.filled(t.logo)?a("h1",{staticClass:"text-main h3"},[a("span",{staticClass:"login-logo d-block d-sm-inline"},[a("img",{staticClass:"mb-3",staticStyle:{"max-height":"42px"},attrs:{src:t.logo,alt:""}})]),a("br"),a("span",{staticClass:"d-block d-sm-inline"},[t._v(t._s(t.array_get(t.trans,"title")))])]):a("h1",{staticClass:"text-main h3"},[a("span",{staticClass:"d-block d-sm-inline"},[t._v(t._s(t.array_get(t.trans,"title")))])]),t._v(" "),t.two_fa_seconds<=0?a("p",{staticClass:"mb-4 my-4"},[t._v(t._s(t.array_get(t.trans,"module.message.verify_expired")))]):t._e(),t._v(" "),t.two_fa_seconds<=0?a("p",{staticClass:"mb-4"},[a("button",{staticClass:"btn btn-main rounded",attrs:{type:"button"},on:{click:function(a){return t.resetLogin()}}},[t._v("\n              "+t._s(t.array_get(t.trans,"module.button.login_again"))+"\n            ")])]):t._e(),t._v(" "),t.two_fa_seconds>0?a("div",{staticClass:"login-form mt-4",on:{keypress:function(a){return t.submitVerify(a)}}},[a("p",{staticClass:"mb-4"},[t._v(t._s(t.verify_timer))]),t._v(" "),a("div",{staticClass:"form-group row"},[a("label",{staticClass:"col-auto col-form-label",attrs:{for:"login-verify-code"}},[t._v("\n                "+t._s(t.array_get(t.trans,"module.verify_code"))+"\n              ")]),t._v(" "),a("div",{staticClass:"col"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.two_fa_code,expression:"two_fa_code"}],staticClass:"form-control",attrs:{id:"login-verify-code",type:"text",autocomplete:"off",required:""},domProps:{value:t.two_fa_code},on:{input:function(a){a.target.composing||(t.two_fa_code=a.target.value)}}})]),t._v(" "),t._m(2)]),t._v(" "),a("div",{staticClass:"row align-items-center mt-4"},[a("div",{staticClass:"col-sm text-md-right col-xs-12 text-center mt-4 mt-md-2"},[a("button",{staticClass:"btn btn-default btn-lg rounded",attrs:{type:"button"},on:{click:function(a){return t.resetLogin()}}},[t._v("\n                  "+t._s(t.array_get(t.trans,"module.button.login_again"))+"\n                ")]),t._v(" "),t.logging?a("button",{staticClass:"btn btn-main btn-lg rounded",attrs:{type:"button",disabled:""}},[t._v("\n                  "+t._s(t.array_get(t.trans,"module.button.logging"))+"\n                ")]):a("button",{staticClass:"btn btn-main btn-lg rounded",attrs:{type:"button"},on:{click:function(a){return t.twoFAVerify()}}},[t._v("\n                  "+t._s(t.array_get(t.trans,"module.button.verify_login"))+"\n                ")])])]),t._v(" "),a("div",{staticClass:"alert alert-danger error fade mt-3",class:{show:t.filled(t.login_error)},attrs:{role:"alert"}},[a("span",{staticClass:"text"},[t._v(t._s(t.login_error)+"Â ")])])]):t._e()]):t._e()]),t._v(" "),a("div",{staticClass:"col d-md-block d-none"},[a("div",{staticClass:"welcome-panl"},[a("h2",{staticClass:"mb-3"},[t._v(t._s(t.array_get(t.trans,"module.topic")))]),t._v(" "),a("p",{domProps:{innerHTML:t._s(t.array_get(t.trans,"module.information"))}})])])])]),t._v(" "),a("div",{staticClass:"login-footer"},[a("div",{staticClass:"login-copyright mb-3"},[a("p",[t._v("Copyright Â© "+t._s(t.array_get(t.footer,"author"))+" "+t._s(t.array_get(t.footer,"year")))])])]),t._v(" "),t.filled(t.backgrounds)?a("div",{staticClass:"login-bg"},[a("div",{staticClass:"swiper-container",attrs:{id:"login-swiper"}},[a("div",{staticClass:"swiper-wrapper"},t._l(t.backgrounds,(function(t){return a("div",{staticClass:"swiper-slide"},[a("img",{attrs:{src:t,alt:""}})])})),0)])]):t._e()])}),[function(){var t=this._self._c;return t("div",{staticClass:"col-auto d-none d-sm-block"},[t("i",{staticClass:"icon-profile-male h2 text-muted"})])},function(){var t=this._self._c;return t("div",{staticClass:"col-auto d-none d-sm-block"},[t("i",{staticClass:"icon-key2 h2 text-muted"})])},function(){var t=this._self._c;return t("div",{staticClass:"col-auto d-none d-sm-block"},[t("i",{staticClass:"icon-key2 h2 text-muted"})])}],!1,null,null,null).exports}}]);
//# sourceMappingURL=Site-Login.js.map